<VirtualHost *:80>
    DocumentRoot /var/www

    <Directory "/var/www">
<% if @http_basic_auth_password and !@http_basic_auth_password.empty? -%>
      AuthType Basic
      AuthName "Authentication Required"
      AuthUserFile "/etc/htpasswd/.htpasswd"
      Require valid-user
<% end -%>

      AllowOverride All
      Require all granted
    </Directory>
</VirtualHost>
